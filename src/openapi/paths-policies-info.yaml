get:
  tags:
    - Erweiterung SchulConneX
  summary: Nutzungsrechte als Policies (ODRL PolicyType "Set") im Kontext eines Benutzers abrufen
  description: |
    # Nutzungsrechte-Informationen (Policies)
    Gibt eine Liste von Informationen zu Nutzungsrechten (als ODRL vom PolicyType "Set") für den autorisierten Benutzer zurück.

    Dieser API-Endpunkt ermöglicht das Anfordern von Informationen zu Nutzungsrechten für den autorisierten Benutzer.
    Die Antwort-Nutzlast ist eine Liste von ODRL-Zuweisungen, welche als Plicy (Nutzungsrecht) verstanden wird.
    Policies (Nutzungsrechte) sind nach ODRL definiert und entsprechen dem ODRL Policy-Type "Set".

    Dieser API-Endpunkt ermöglicht _optional_ das Anfordern von Zugriffs-Informationen als Access-rights für die Nutzungsrechte als Policies.
    Die Antwort-Nutzlast würde die Zugriffs-Informationen zu dem jeweiligen Nutzungsrecht im Attribut `scx:access_control` enthalten.

    Der API-Endpunkt unterstützt Client-seitige `Content negotiation` über den Accept-Header.
    Der Client kann das Datenmodell der Antwort-Nutzlast festlegen, sofern diese Unterstützt werden.
  parameters:
    - name: Authorization
      in: header
      description: Der OIDC Access-Token des Benutzers.
      required: true
      schema:
        type: string
      example: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    - name: Accept
      in: header
      description: Parameter für die Festlegung des Datenmodells der Antwort-Nutzlast. ([Content negotiation on mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation)).
      required: false
      schema:
        type: string
        enum:
          - "application/ld+json"
          - "application/json"
        default: application/json
      example: application/json
    - name: target.uid
      in: query
      description: Die ID eines spezifischen Mediums als Query-Filter-Parameter.
      required: false
      schema:
        type: string
        example: "urn:example:medium:123456789"
    - name: target.partOf
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen eines spezifischen Medienkatalogs.
      required: false
      allowEmptyValue: true
      schema:
        type: string
      example: "urn:exampleprovider:media:catalog"
    - name: permission.action
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen einer spezifischen Art von Nutzungsrecht.
      required: false
      allowEmptyValue: true
      schema:
        type: string
        enum:
          - "distribute"
          - "execute"
          - "move"
          - "play"
          - "print"
          - "view"
      example: "execute"
    - name: personenkontext.organisation.kennung
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen einer spezifischen Schulzugehörigkeit.
      required: false
      allowEmptyValue: true
      schema:
        type: string
      example: "NI_12345"
    - name: personenkontext.gruppe
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen einer spezifischen Gruppenzugehörigkeit.
      required: false
      allowEmptyValue: true
      schema:
        type: string
      example: "ffceeb40-01e6-483f-a909-382ff576b429"
    - name: personenkontext.rolle
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen einer spezifischen Rolle.
      required: false
      allowEmptyValue: true
      schema:
        type: string
      example: "lehr"
    - name: access_control
      in: query
      description: Ein optionaler Filter-Parameter zum zusätzlichen Abfragen der Zugriffs-Informationen als Attribute `scx:access_control`.
      required: false
      allowEmptyValue: true
      schema:
        type: string
        enum:
          - "none"
          - "urn:scx:lizenz:zugriffsinfo:licensekey"
          - "urn:scx:lizenz:zugriffsinfo:temporaryurl"
          - "all"
      example: "none"
    - name: discover_error
      in: query
      description: Ein optionaler Filter-Parameter zum Abfragen von Discover-Fehlerinformationen von Providern. Führt bei Auftreten einer Fehlerinformation zum führen des Custom-Header `Content-Partial-Error` mit dem Wert "true" in der Antwort.
      required: false
      allowEmptyValue: true
      schema:
        type: boolean
      example: false
  responses:
    200:
      description: Returns an array of policies
      headers:
        Content-Partial-Error:
          schema:
            type: boolean
          example: false
          description: Hinweis auf Fehler im Payload.
      content:
        application/json:
          schema:
            type: array
            items:
              anyOf:
                - $ref: "./components-NutzungsrechtInfoJSON.yaml"
                - $ref: "./components-DiscoverActionJSON.yaml"
          # examples:
          #   "Nutzungsrecht ohne Zugriffs-Informationen":
          #     value:
          #       - $ref: "../../static/examples/policies/1_anwendung.execute.json"
          #   "Nutzungsrecht mit Zugriffs-Informationen":
          #     value:
          #       - $ref: "../../static/examples/policies/1_anwendung.execute.access_control.json"
          #   "Antwort mit Fehlerinformationen von Providern":
          #     value:
          #       $ref: "../../static/examples/response_payload/218_provider_error.json"
        application/ld+json:
          schema:
            type: array
            items:
              anyOf:
                - $ref: "./components-NutzungsrechtInfoJSONLD.yaml"
                - $ref: "./components-DiscoverActionJSONLD.yaml"
          # examples:
          #   "Nutzungsrecht ohne Zugriffs-Informationen":
          #     value:
          #       - $ref: "../../static/examples/policies/1_anwendung.execute.ld.json"
          #   "Nutzungsrecht mit Zugriffs-Informationen":
          #     value:
          #       - $ref: "../../static/examples/policies/1_anwendung.execute.access_control.ld.json"
          #   "Antwort mit Fehlerinformationen von Providern":
          #     value:
          #       $ref: "../../static/examples/response_payload/218_provider_error.ld.json"
    401:
      description: Unauthorized
    404:
      description: Not found
    500:
      description: Internal Server Error
    503:
      description: Service Unavailable
